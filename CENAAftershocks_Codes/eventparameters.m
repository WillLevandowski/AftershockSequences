if events_loop==1;y0=2005;m0=4.57;mc=1.37;bg_duration=21;bg_delay=0;total_duration=11;end
    if events_loop==2;y0=2003;m0=4.59;mc=2.24;bg_duration=20;bg_delay=0;total_duration=2021.5-y0;  end 
    if events_loop==3;y0=2000;m0=4.57;mc=1.17;bg_duration=20;bg_delay=0;total_duration=22;  end 
    if events_loop==4;y0=1990;m0=4.56;mc=1.57;bg_duration=0;bg_delay=10;total_duration=26.5; end 
    if events_loop==5;y0=1976;m0=4.62;mc=2.24;bg_duration=0;bg_delay=10;total_duration=35;  end 
     if events_loop==6; y0=2010;m0=5.04;mc=1.97;bg_duration=10;bg_delay=0;total_duration=2016.5-y0;end
     if events_loop==7;y0=2002;m0=4.97;mc=1.37;bg_duration=0;bg_delay=7.5;total_duration=15; end
     if events_loop==8; y0=2008;m0=5.23;mc=2.28;bg_duration=20;bg_delay=0;total_duration=2022-y0;end
     if events_loop==9; y0=1983;m0=4.83;mc=2.41;bg_duration=9;bg_delay=0;total_duration=20;end
     if events_loop==11;      y0=1982;m0=5.47;mc=2.47;    bg_duration=8;bg_delay=0;total_duration=34;end
     if events_loop==155;      y0=1982;m0=5.47;mc=2.27;    bg_duration=0;bg_delay=30;total_duration=40;end
     if events_loop==12; y0=1987;m0=4.96;mc=2.24;bg_duration=0;bg_delay=5;total_duration=20;end
     if events_loop==13; y0=1980;m0=5.04;mc=2.01;bg_duration=0;bg_delay=20;total_duration=2021.5-y0;end
     if events_loop==14; y0=1979;m0=4.75;mc=2.24;bg_duration=0;bg_delay=15;total_duration=2021.5-y0;end
     if events_loop==15;y0=2011;m0=5.65;mc=2.18;bg_duration=31;bg_delay=0;total_duration=2021.5-y0;  end 
     if events_loop==10; y0=1997;m0=4.47;mc=1.17;bg_duration=0;bg_delay=10;total_duration=20;end
     if events_loop==16; y0=1987;m0=3.61;mc=2.37;bg_duration=0;bg_delay=10.55;total_duration=35;end  
     if events_loop==17; y0=1999;m0=4.39;mc=1.37;bg_duration=0;bg_delay=10;total_duration=2021.5-y0;end 
  if events_loop==18; y0=1982;m0=4.38;mc=2.24;bg_duration=8.5;bg_delay=0;total_duration=27.7;end
     if events_loop==19; y0=1990;m0=4.28;mc=2.39;bg_duration=0;bg_delay=9.88;total_duration=30;end
     if events_loop==20; y0=1987;m0=4.28;mc=2.24;bg_duration=0;bg_delay=10;total_duration=20;end
     if events_loop==21;y0=1990;total_duration=2021.5-y0;bg_duration=0;m0=3.67;mc=1.47;bg_delay=15;end
if events_loop==22; y0=1997;m0=4.26;mc=1.67;bg_duration=0;bg_delay=10;total_duration=2021.5-y0;end      
     if events_loop==24; y0=1988;m0=5.80;mc=2.07;bg_duration=0;bg_delay=10;total_duration=22.5;end
     if events_loop==156; y0=1988;m0=5.84;mc=1.67;bg_duration=0;bg_delay=10;total_duration=22.5;end
          if events_loop==25; y0=2001;m0=4.30;mc=1.57;bg_duration=0;bg_delay=5;total_duration=2022-y0;end
          if events_loop==157; y0=2001;m0=4.30;mc=1.37;bg_duration=0;bg_delay=10;total_duration=2022-y0;end
          if events_loop==26; y0=1986;m0=4.63;mc=2.07;bg_duration=12;bg_delay=0;total_duration=30;end
      if events_loop==27; y0=2004;m0=4.25;mc=2.62;bg_duration=15.5;bg_delay=0;total_duration=10.05;end
      if events_loop==28; y0=1984;m0=4.23;mc=2.24;bg_duration=0;bg_delay=10;total_duration=30;end
      if events_loop==29; y0=2005;m0=4.22;mc=2.24;bg_duration=15;bg_delay=0;total_duration=12;end
      if events_loop==30; y0=1988;m0=4.17;mc=2.55;bg_duration=14;bg_delay=0;total_duration=20;end
      if events_loop==31; y0=2012;m0=4.16;mc=2.47;bg_duration=y0-1973;bg_delay=0;total_duration=2022-y0;end %%%%%%%%%%2012
      if events_loop==32; y0=1982;m0=4.22;mc=2.30;bg_duration=0;bg_delay=10;total_duration=35;end
      if events_loop==33; y0=1983;m0=3.70;mc=1.87;bg_duration=0;bg_delay=10;total_duration=2021.5-y0;end
      if events_loop==34; y0=1995;m0=3.7;mc=2.50;bg_duration=21;bg_delay=0;total_duration=2021.5-y0;end
      if events_loop==35; y0=2006;m0=3.7;mc=1.17;bg_duration=15;bg_delay=0;total_duration=2022-y0;end
       if events_loop==36; y0=1998;m0=3.7;mc=1.27;bg_duration=0;bg_delay=10;total_duration=2021.5-y0;end
       if events_loop==37; y0=1989;m0=3.71;mc=1.47;bg_duration=0;bg_delay=10;total_duration=32.5;end
    if events_loop==38; y0=1977;m0=3.74;mc=1.67;bg_duration=0;bg_delay=10;total_duration=21;end
    if events_loop==39; y0=2003;m0=3.71;mc=2.39;bg_duration=29;bg_delay=0;total_duration=2021.5-y0;end
        if events_loop==40; y0=2003;m0=4.02;mc=2.30;bg_duration=0;bg_delay=10;total_duration=18.5;end
        if events_loop==41; y0=1975;m0=4.12;mc=2.37;bg_duration=0;bg_delay=20;total_duration=2022-y0;end
        if events_loop==42; y0=1991;m0=4.07;mc=1.37;bg_duration=0;bg_delay=10;total_duration=2021.5-y0;end
        if events_loop==43;  y0=1991;m0=4.13;mc=2.24;bg_duration=0;bg_delay=7.5;total_duration=15;end
         if events_loop==44;y0=1979;m0=4.14;mc=2.27;bg_duration=0; bg_delay=10;total_duration=2021.5-y0;end
         if events_loop==45;y0=1979;m0=3.99;mc=2.5;bg_duration=0; bg_delay=10;total_duration=2021.5-y0;end
       if events_loop==46;y0=2006;m0=3.98;mc=2.55;bg_duration=y0-1973; bg_delay=0;total_duration=2021.5-y0;end
        if events_loop==47;y0=1987;m0=3.98;mc=2.24;bg_duration=10;bg_delay=0;total_duration=10;end
        if events_loop==48; y0=1983;m0=3.98;mc=2.55;bg_duration=0;bg_delay=15;total_duration=2021.5-y0;end
         if events_loop==49; y0=1994;m0=3.85;mc=2.47;bg_duration=0;bg_delay=10;total_duration=2021.5-y0;end
        if events_loop==50;   y0=1989;m0=3.85;mc=1.97;bg_duration=0;bg_delay=15;total_duration=2021.5-y0;end
         if events_loop==51;  y0=1979;m0=3.84;mc=2.50;bg_duration=0; bg_delay=10;total_duration=2021.5-y0;end
          if events_loop==52;  y0=1975;m0=3.84;mc=2.55;bg_duration=0; bg_delay=20;total_duration=2021.5-y0;end
           if events_loop==53;  y0=2001;m0=3.79;mc=1.57;bg_duration=15; bg_delay=0;total_duration=2021.5-y0;end
   if events_loop==54;y0=1996;m0=3.78;mc=2.24;bg_duration=y0-1973; bg_delay=0;total_duration=2021.5-y0;end
   if events_loop==55;y0=1992;m0=3.78;mc=2.20;bg_duration=0; bg_delay=12.4;total_duration=2021.5-y0;end
   if events_loop==56;y0=1990;m0=3.78;mc=2.58;bg_duration=y0-1973; bg_delay=0;total_duration=2021.5-y0;  end
   if events_loop==57;y0=1987;m0=3.78;mc=2.47;bg_duration=13; bg_delay=0;total_duration=25;  end
   if events_loop==58;y0=1984;m0=3.78;mc=2.32;bg_duration=0; bg_delay=20;total_duration=2021.5-y0;  end
   if events_loop==59;y0=1997;m0=3.77;mc=1.17;bg_duration=0; bg_delay=10;total_duration=2021.5-y0;end
   if events_loop==60;y0=2003;m0=3.77;mc=1.47;bg_duration=29; bg_delay=0;total_duration=2021.5-y0;end
   if events_loop==61; y0=2006;m0=3.77;mc=1.17;bg_duration=0; bg_delay=10;total_duration=2022-y0;end
   if events_loop==62; y0=1977;m0=3.75;mc=2.27;bg_duration=0; bg_delay=17.1;total_duration=40;end
   if events_loop==63; y0=1986;m0=3.73;mc=1.37;bg_duration=0;bg_delay=11;total_duration=2022-y0;end 
   if events_loop==64; y0=1975;m0=3.74;mc=2.25;bg_duration=0;bg_delay=3.2;total_duration=10.025;end 
   if events_loop==65; y0=1980;m0=3.74;mc=2.65;bg_duration=y0-1973;bg_delay=10;total_duration=2021.5-y0;end 
   if events_loop==66; y0=1986;m0=4.40;mc=2.50;bg_duration=y0-1973;bg_delay=0;total_duration=2021.5-y0;end 
   if events_loop==67; y0=1998;m0=4.47;mc=1.37;bg_duration=0;bg_delay=10;total_duration=2022-y0;end 
   if events_loop==68; y0=2002;m0=4.49;mc=2.50;bg_duration=y0-1973;bg_delay=0;total_duration=2022-y0;end 
    if events_loop==69; y0=2011;m0=3.86;mc=2.50;bg_duration=30;bg_delay=0;total_duration=2021.5-y0;end
 if events_loop==70; y0=2003;m0=4.18;mc=2.18;bg_duration=y0-1973; bg_delay=0;total_duration=7.7;end
 if events_loop==71; y0=1978;m0=4.51;mc=2.38;bg_delay=10;total_duration=29;bg_duration=y0-1973; end
 if events_loop==72; y0=1975;m0=4.48;mc=2.50;bg_delay=10;total_duration=20;bg_duration=0; end
 if events_loop==73; y0=1975;m0=4.30;mc=2.50;bg_delay=10;total_duration=2021.5-y0;bg_duration=0; end
  if events_loop==74;y0=1983;bg_duration=y0-1973;m0=4.28;mc=2.50;bg_delay=10;total_duration=2021.5-y0;end
 if events_loop==75;y0=1992;total_duration=25;m0=4.28;mc=2.55;bg_delay=10;bg_duration=0;end
 if events_loop==76;y0=1981;total_duration=2021.5-y0;bg_duration=0;m0=4.18;mc=1.78;bg_delay=10;end
 if events_loop==77;y0=2002;total_duration=2021.5-y0;bg_duration=y0-1973;m0=4.14;mc=2.48;bg_delay=0;end
 if events_loop==78;y0=2005;total_duration=2021.5-y0;m0=4.14;mc=2.38;bg_delay=0;bg_duration=y0-1973;end
 if events_loop==79;y0=1982;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.98;mc=2.48;bg_delay=0;end
 if events_loop==80;y0=1982;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.98;mc=2.48;bg_delay=0;end
if events_loop==81;y0=2003;total_duration=2021.5-y0;bg_duration=20;m0=3.93;mc=2.6;bg_delay=0;end
 if events_loop==82;y0=2009;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.88;mc=2.38;bg_delay=0;end
if events_loop==83;y0=1998;bg_duration=y0-1973;m0=3.88;mc=2.48;bg_delay=0;total_duration=10;end %%% OK
if events_loop==84;y0=2009;total_duration=2021.5-y0;m0=3.85;mc=2.5;bg_delay=0;bg_duration=20.5;end %%% Cheraw
if events_loop==85;y0=1993;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.78;mc=2.50;bg_delay=0;end
if events_loop==86;y0=1999;total_duration=20;bg_duration=y0-1973;m0=3.68;mc=2.38;bg_delay=0;end
if events_loop==87;y0=2008;total_duration=2021.5-y0;bg_duration=15;m0=3.72;mc=2.48;bg_delay=0;end
if events_loop==88;y0=2011;total_duration=2021.5-y0;bg_duration=25;m0=3.68;mc=2.48;bg_delay=0;end % Ardmore/Toadstool NE/SD
if events_loop==89;y0=1990;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.68;mc=2.48;bg_delay=0;end % Manderson, SD
if events_loop==90;y0=1994;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.68;mc=2.38;bg_delay=0;end % Castle Rock, CO
if events_loop==92;y0=1984;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.68;mc=2.50;bg_delay=0;end% Tapawingo, IN
if events_loop==93;y0=1998;m0=3.67;mc=1.47;bg_delay=0;total_duration=10; bg_duration=5; end
if events_loop==94;y0=2007;total_duration=2021.5-y0;bg_duration=10;m0=3.67;mc=1.37;bg_delay=0;end
if events_loop==95;y0=2010;total_duration=2021.5-y0;m0=3.67;mc=1.47;bg_delay=0;bg_duration=10; end
if events_loop==96;y0=2013;total_duration=2021.5-y0;bg_duration=20;m0=3.67;mc=2.24;bg_delay=0;end%%%%%%%%%%%%%2013
if events_loop==97;y0=1985;total_duration=2016.5-y0;m0=3.65;mc=2.16;bg_delay=15;bg_duration=0;end
if events_loop==98;y0=2005;m0=3.65;mc=2.55;bg_delay=0;total_duration=2021.5-y0; bg_duration=12.5; end
if events_loop==99;y0=1975;m0=3.65;mc=2.48;bg_delay=20;total_duration=2021.5-y0; bg_duration=0; end
if events_loop==100;y0=1979;m0=3.65;mc=2.37;bg_delay=20;total_duration=2021.5-y0; bg_duration=0; end
if events_loop==101;y0=2010;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.82;mc=2.48;bg_delay=0;end
if events_loop==102;y0=1981;m0=4.04;mc=2.5;bg_delay=10;total_duration=2021.5-y0; bg_duration=0; end
if events_loop==103;y0=1977;total_duration=2021.5-y0;bg_duration=y0-1973;m0=4.01;mc=1.85;bg_delay=15;end
if events_loop==104;y0=2012;total_duration=2021.5-y0;bg_duration=10;m0=3.86;mc=2.24;bg_delay=0;end
if events_loop==105;y0=2012;total_duration=2021.5-y0;bg_duration=35;m0=3.84;mc=2.32;bg_delay=0;end
if events_loop==106;y0=2012;total_duration=2021.5-y0;bg_duration=10;m0=3.77;mc=1.67;bg_delay=0;end
if events_loop==107;y0=2014;total_duration=2021.5-y0;bg_duration=15;m0=3.75;mc=2.44;bg_delay=0;end
if events_loop==108;y0=2004;total_duration=2021.5-y0;bg_duration=y0-1973;m0=4.15;mc=2.5;bg_delay=0;end
if events_loop==109;y0=2013;total_duration=2021.5-y0;bg_duration=12;m0=4.49;mc=1.37;bg_delay=0;end
if events_loop==110;y0=2012;total_duration=10;bg_duration=10;m0=4.07;mc=1.56;bg_delay=0;end
if events_loop==111;y0=2012;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.81;mc=1.77;bg_delay=0;end
if events_loop==112;y0=2012;total_duration=2022-y0;bg_duration=20;m0=4.03;mc=2.17;bg_delay=0;end
if events_loop==113;y0=2012;total_duration=2021.5-y0;bg_duration=30;m0=3.47;mc=1.77;bg_delay=0;end
if events_loop==114;y0=2013;total_duration=4.16;bg_duration=14.35;m0=3.96;mc=1.17;bg_delay=0;end
if events_loop==115;y0=1993;total_duration=20;bg_duration=0;m0=3.88;mc=1.47;bg_delay=10;end
if events_loop==116;y0=2017;total_duration=4.5;bg_duration=y0-1973;m0=4.1;mc=2.5;bg_delay=0;end
if events_loop==117;y0=2018;total_duration=2021.5-y0;bg_duration=10;m0=4.4;mc=2.18;bg_delay=0;end
if events_loop==118;y0=2012;total_duration=2021.5-y0;bg_duration=25;m0=3.97;mc=1.27;bg_delay=0;end
if events_loop==119;y0=1993;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.90;mc=2.17;bg_delay=0;end
if events_loop==120;y0=2014;total_duration=2022-y0;bg_duration=30;m0=4.11;mc=2.36;bg_delay=0;end
if events_loop==121;y0=2015;total_duration=2;bg_duration=10;m0=3.65;mc=1.17;bg_delay=0;end
if events_loop==122;y0=2015;total_duration=2021.5-y0;bg_duration=y0-1973;m0=4.24;mc=2.45;bg_delay=0;end
if events_loop==123;y0=2019;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.70;mc=2.45;bg_delay=0;end
if events_loop==124;y0=2019;total_duration=2021.5-y0;bg_duration=10;m0=3.69;mc=2.08;bg_delay=0;end
if events_loop==125;y0=2019;total_duration=2021.5-y0;bg_duration=30;m0=3.70;mc=2.34;bg_delay=0;end
if events_loop==126;y0=2020;total_duration=3;bg_duration=10;m0=5.10;mc=2.22;bg_delay=0;end
if events_loop==127;y0=2016;total_duration=2021.5-y0;bg_duration=25;m0=3.7;mc=2.36;bg_delay=0;end
if events_loop==128;y0=2001;total_duration=7.0;bg_duration=10.6;m0=4.34;mc=2.24;bg_delay=0;end
if events_loop==129;y0=1990;total_duration=2021.5-y0;bg_duration=y0-1973;m0=3.77;mc=1.77;bg_delay=0;end
if events_loop==130;y0=2005;total_duration=10;bg_duration=10;m0=3.89;mc=2.24;bg_delay=0;end
if events_loop==131;y0=2006;total_duration=2021.5-y0;bg_duration=0;m0=3.87;mc=1.17;bg_delay=9.1;end
if events_loop==132;y0=1991;total_duration=15;bg_duration=y0-1973;m0=3.94;mc=2.47;bg_delay=0;end
if events_loop==133;y0=2010;total_duration=2021.5-y0;bg_duration=25;m0=3.80;mc=2.28;bg_delay=0;end
if events_loop==134;y0=1980;total_duration=20;bg_duration=0;m0=3.95;mc=2.5;bg_delay=10;end
if events_loop==135;y0=1984;total_duration=19.25;bg_duration=y0-1973;m0=3.88;mc=2.24;bg_delay=0;end
if events_loop==136;y0=1984;total_duration=20;bg_duration=0;m0=3.97;mc=2.47;bg_delay=10;end
if events_loop==137;y0=1995;total_duration=15;bg_duration=15;m0=3.68;mc=2.33;bg_delay=0;end
if events_loop==138;y0=1997;total_duration=10;bg_duration=y0-1973;m0=4.18;mc=2.24;bg_delay=0;end
if events_loop==139;y0=1997;total_duration=2022-y0;bg_duration=y0-1973;m0=4.68;mc=2.59;bg_delay=0;end
if events_loop==140;y0=1974;total_duration=20;bg_duration=0;m0=4.37;mc=2.52;bg_delay=10;end
if events_loop==141;y0=1974;total_duration=30;bg_duration=0;m0=4.34;mc=2.08;bg_delay=15;end
if events_loop==142;y0=1974;total_duration=35;bg_duration=0;m0=3.96;mc=2.50;bg_delay=20;end
if events_loop==143;y0=1974;total_duration=15;bg_duration=0;m0=3.96;mc=2.42;bg_delay=9;end
if events_loop==144;y0=1975;total_duration=25;bg_duration=0;m0=4.08;mc=2.55;bg_delay=10;end
if events_loop==145;y0=1976;total_duration=30;bg_duration=0;m0=3.88;mc=2.38;bg_delay=10;end
if events_loop==146;y0=1978;total_duration=15;bg_duration=y0-1973;m0=3.90;mc=2.47;bg_delay=10;end
if events_loop==147;y0=1989;total_duration=10;bg_duration=14;m0=4.28;mc=2.32;bg_delay=0;end
if events_loop==148;y0=1976;total_duration=20;bg_duration=0;m0=4.05;mc=2.25;bg_delay=10;end
if events_loop==149;y0=1991;total_duration=2022-y0;bg_duration=0;m0=3.97;mc=1.37;bg_delay=10;end
if events_loop==91;y0=2000;total_duration=2022-y0;bg_duration=0;m0=3.45;mc=1.37;bg_delay=10;end
if events_loop==999;y0=2014;m0=6.02;mc=1.6;bg_duration=10;bg_delay=0;total_duration=2021.5-2014.65;end

set_catalog

Main=find(yr==y0 & mag==m0,1,'first');  
    switch_Mainshock; %%% some events are the last M=m0 of the year; a few sequences begin with foreshocks
    
    %%% 
    if bg_duration==y0-1973;bg_duration=dec_yr(Main)-min(dec_yr);end
    after=dec_yr-dec_yr(Main);

    dx=(Lon-Lon(Main)).*cosd(Lat(Main))*111.12;dy=(Lat-Lat(Main))*111.12;r=sqrt(dx.^2+dy.^2); 
    GK74_r=10^(0.983 +0.1238*m0);
    setRadii; %%% in some cases, different radii are used for regional mc or background rates 
    bg_start=dec_yr(Main)-bg_duration;
    bg_end=dec_yr(Main);
    af_start=dec_yr(Main);
    af_end=dec_yr(Main)+total_duration;
    if bg_delay > 0
        bg_start=dec_yr(Main)+bg_delay; 
        bg_end=dec_yr(Main)+total_duration;
        af_end=dec_yr(Main)+bg_delay; 
    end

    area_for_bg=pi*r_bg^2; area_for_af=pi*r_af^2;
    GK74_dur=10^(0.556*m0-0.6027)/365;
    figtitle=['M' num2str(m0) ' ' num2str(yr(Main)) ' Event'];
